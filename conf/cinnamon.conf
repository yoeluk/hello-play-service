cinnamon.application = "play-service"

cinnamon.play.http.servers {
  "*:*" {
    paths {
      "*" {
        metrics = on
        traceable = on
      }
    }
  }
}

cinnamon.play.http.clients {
  "*:*" {
    paths {
      "*" {
        metrics = on
        traceable = on
      }
    }
  }
}

cinnamon.java {
  future.instrumentation = on
  future.metrics {
    names = ["*"]
  }
}

cinnamon.prometheus {
  exporters += http-server
  http-server {
    host = "0.0.0.0"
    port = 9002
  }
  use-default-registry = on
  hints {
    custom-recorder {
      histogram {
        linear-buckets {
          start = 1
          width = 2
          count = 5
        }
      }
    }
  }
}

zipkin-host = localhost
zipkin-host = ${?ZIPKIN_HOST}

cinnamon.opentracing {
  http {
    tag-headers += "X-Correlation-Id"
    tag-headers += "msgid"
  }
  zipkin {
    url-connection {
      endpoint = "http://"${?zipkin-host}":9411/api/v2/spans"
      encoding = "proto3"
    }
  }

  tracer {
    propagations += b3-propagation
    service-name = "play-backend"
    tags {
      environment = "test"
    }
    sampler = rate-limiting-sampler
    rate-limiting-sampler {
      max-traces-per-second = 15
    }
  }
}